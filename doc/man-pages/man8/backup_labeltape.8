.rn '' }`
''' $RCSfile$$Revision$$Date$
'''
''' $Log$
'''
.de Sh
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp
.if t .sp .5v
.if n .sp
..
.de Ip
.br
.ie \\n(.$>=3 .ne \\$3
.el .ne 3
.IP "\\$1" \\$2
..
.de Vb
.ft CW
.nf
.ne \\$1
..
.de Ve
.ft R

.fi
..
'''
'''
'''     Set up \*(-- to give an unbreakable dash;
'''     string Tr holds user defined translation string.
'''     Bell System Logo is used as a dummy character.
'''
.tr \(*W-|\(bv\*(Tr
.ie n \{\
.ds -- \(*W-
.ds PI pi
.if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\" diablo 12 pitch
.ds L" ""
.ds R" ""
'''   \*(M", \*(S", \*(N" and \*(T" are the equivalent of
'''   \*(L" and \*(R", except that they are used on ".xx" lines,
'''   such as .IP and .SH, which do another additional levels of
'''   double-quote interpretation
.ds M" """
.ds S" """
.ds N" """""
.ds T" """""
.ds L' '
.ds R' '
.ds M' '
.ds S' '
.ds N' '
.ds T' '
'br\}
.el\{\
.ds -- \(em\|
.tr \*(Tr
.ds L" ``
.ds R" ''
.ds M" ``
.ds S" ''
.ds N" ``
.ds T" ''
.ds L' `
.ds R' '
.ds M' `
.ds S' '
.ds N' `
.ds T' '
.ds PI \(*p
'br\}
.\"	If the F register is turned on, we'll generate
.\"	index entries out stderr for the following things:
.\"		TH	Title 
.\"		SH	Header
.\"		Sh	Subsection 
.\"		Ip	Item
.\"		X<>	Xref  (embedded
.\"	Of course, you have to process the output yourself
.\"	in some meaninful fashion.
.if \nF \{
.de IX
.tm Index:\\$1\t\\n%\t"\\$2"
..
.nr % 0
.rr F
.\}
.TH backup_labeltape 8 "OpenAFS" "1/Mar/2006" "AFS Command Reference"
.UC
.if n .hy 0
.if n .na
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.de CQ          \" put $1 in typewriter font
.ft CW
'if n "\c
'if t \\&\\$1\c
'if n \\&\\$1\c
'if n \&"
\\&\\$2 \\$3 \\$4 \\$5 \\$6 \\$7
'.ft R
..
.\" @(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2
.	\" AM - accent mark definitions
.bd B 3
.	\" fudge factors for nroff and troff
.if n \{\
.	ds #H 0
.	ds #V .8m
.	ds #F .3m
.	ds #[ \f1
.	ds #] \fP
.\}
.if t \{\
.	ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.	ds #V .6m
.	ds #F 0
.	ds #[ \&
.	ds #] \&
.\}
.	\" simple accents for nroff and troff
.if n \{\
.	ds ' \&
.	ds ` \&
.	ds ^ \&
.	ds , \&
.	ds ~ ~
.	ds ? ?
.	ds ! !
.	ds /
.	ds q
.\}
.if t \{\
.	ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.	ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.	ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.	ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.	ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.	ds ? \s-2c\h'-\w'c'u*7/10'\u\h'\*(#H'\zi\d\s+2\h'\w'c'u*8/10'
.	ds ! \s-2\(or\s+2\h'-\w'\(or'u'\v'-.8m'.\v'.8m'
.	ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.	ds q o\h'-\w'o'u*8/10'\s-4\v'.4m'\z\(*i\v'-.4m'\s+4\h'\w'o'u*8/10'
.\}
.	\" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds v \\k:\h'-(\\n(.wu*9/10-\*(#H)'\v'-\*(#V'\*(#[\s-4v\s0\v'\*(#V'\h'|\\n:u'\*(#]
.ds _ \\k:\h'-(\\n(.wu*9/10-\*(#H+(\*(#F*2/3))'\v'-.4m'\z\(hy\v'.4m'\h'|\\n:u'
.ds . \\k:\h'-(\\n(.wu*8/10)'\v'\*(#V*4/10'\z.\v'-\*(#V*4/10'\h'|\\n:u'
.ds 3 \*(#[\v'.2m'\s-2\&3\s0\v'-.2m'\*(#]
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.ds oe o\h'-(\w'o'u*4/10)'e
.ds Oe O\h'-(\w'O'u*4/10)'E
.	\" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.	\" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.	ds : e
.	ds 8 ss
.	ds v \h'-1'\o'\(aa\(ga'
.	ds _ \h'-1'^
.	ds . \h'-1'.
.	ds 3 3
.	ds o a
.	ds d- d\h'-1'\(ga
.	ds D- D\h'-1'\(hy
.	ds th \o'bp'
.	ds Th \o'LP'
.	ds ae ae
.	ds Ae AE
.	ds oe oe
.	ds Oe OE
.\}
.rm #[ #] #H #V #F C
.SH "NAME"
backup labeltape \- Creates the magnetic label on a tape
.SH "SYNOPSIS"
\fBbackup labeltape\fR <<\ [\fB\-name\fR\ <\fIAFS\ tape\ name,\ defaults\ to\ NULL\fR] >>>
    <<\ [\fB\-size\fR\ <\fItape\ size\ in\ Kbytes,\ defaults\ to\ size\ in\ tapeconfig\fR] >>>
    <<\ [\fB\-portoffset\fR\ <\fITC\ port\ offset\fR] >>> <<\ [\fB\-pname\fR\ <\fIpermanent\ tape\ name\fR] >>>
    [\fB\-localauth\fR] <<\ [\fB\-cell\fR\ <\fIcell\ name\fR] >>> [\fB\-help\fR]
.PP
\fBbackup la\fR <<\ [\fB\-n\fR\ <\fIAFS\ tape\ name,\ defaults\ to\ NULL\fR] >>>
    <<\ [\fB\-s\fR\ <\fItape\ size\ in\ Kbytes,\ defaults\ to\ size\ in\ tapeconfig\fR] >>>
    <<\ [\fB\-po\fR\ <\fITC\ port\ offset\fR] >>> <<\ [\fB\-pn\fR\ <\fIpermanent\ tape\ name\fR] >>>
    [\fB\-l\fR] <<\ [\fB\-c\fR\ <\fIcell\ name\fR] >>> [\fB\-h\fR]
.SH "DESCRIPTION"
The \fBbackup labeltape\fR command creates a magnetic label, readable by the
Backup System, at the beginning of a tape. The label records the tape's
name (either a \fIpermanent name\fR, or an \fIAFS tape name\fR that reflects the
tape's contents in a prescribed format) and its capacity.
.PP
(If the \f(CWFILE YES\fR instruction appears in the
\fI/usr/afs/backup/CFG_\fIdevice_name\fR\fR file on the Tape Coordinator machine
associated with the specified port offset, then the \fBbackup\fR command
writes label information to the first 16 KB block in the backup data file
listed for that port offset in the Tape Coordinator's
\fI/usr/afs/backup/tapeconfig\fR file, rather than at the beginning of a
tape. For the sake of clarity, the following text refers to tapes only,
but the Backup System handles backup data files in much the same way.)
.PP
Relabeling a tape that already contains AFS backup data effectively makes
the data unusable, because the command removes the Backup Database record
of the complete dump set of which the tape is a part. Use this command to
enable recycling of a tape that contains unexpired dumps that are not
actually still needed.
.PP
To write a permanent name on the label, include the \fB\-pname\fR argument to
specify a string of up to 32 characters. The permanent name persists until
the \fB\-pname\fR argument is again included on the \fBbackup labeltape\fR
command, regardless of the tape's contents and of how often the tape is
otherwise relabeled or recycled. Include this argument or the \fB\-name\fR
argument, but not both. If this argument is included, the AFS tape name is
set to \f(CW< <NULL\fR >>.  The permanent name is set to \f(CW< <NULL\fR >> if this
argument is omitted and no permanent name already exists.
.PP
The issuer must ensure that a permanent name is unique among the tapes
used for AFS backup in the cell, because the \fBbackup\fR command interpreter
does not verify that another tape does not already have the same permanent
name. When a tape has a permanent name, the Backup System uses it instead
of the AFS tape name in most prompts and when referring to the tape in
output from \fBbackup\fR commands. The permanent name appears in the \f(CWtape
name\fR field of the output from the \fBbackup readlabel\fR command.
.PP
To write an AFS tape name on the label, provide a value for the \fB\-name\fR
argument in the required format described in the \fIOPTIONS\fR manpage.  Include the
\fB\-name\fR argument or the \fB\-pname\fR argument, but not both. If this
argument is omitted, the AFS tape name is set to \f(CW< <NULL\fR >>, but the
Backup System automatically assigns the appropriate name when the tape is
used in a future \fBbackup dump\fR or \fBbackup savedb\fR operation.  The AFS
tape name appears in the \f(CWAFS tape name\fR field of the output from the
\fBbackup readlabel\fR and \fBbackup scantape\fR commands.
.PP
The backup command interpreter does not accept the \fB\-name\fR argument if
the tape already has a permanent name. To erase a tape's permanent name,
provide a null value to the \fB\-pname\fR argument by issuing the following
command:
.PP
.Vb 1
\&   % backup labeltape -pname ""
.Ve
To record the tape's capacity on the label, specify a number of kilobytes
as the \fB\-size\fR argument. If the argument is omitted the first time a tape
is labeled, the Backup System records the default tape capacity recorded
for the specified port offset in the \fI/usr/afs/backup/tapeconfig\fR file on
the Tape Coordinator machine. Subsequently, the value in the size field
persists until the \fB\-size\fR argument is again included on the \fBbackup
labeltape\fR command.
.PP
To determine how much data can be written to a tape during a backup dump
or \fBbackup savedb\fR operation, the Tape Coordinator reads the capacity
recorded on the tape's label (or uses the value associated with its port
offset in the \fI/usr/afs/backup/tapeconfig\fR file, if the tape was never
labeled). For further description, see the \fBbackup dump\fR reference page.
.PP
The Tape Coordinator's default response to this command is to access the
tape by invoking the \f(CWMOUNT\fR instruction in the local
\fI/usr/afs/backup/CFG_\fIdevice_name\fR\fR file, or by prompting the backup
operator to insert the tape if there is no \f(CWMOUNT\fR instruction. However,
if the \f(CWAUTOQUERY NO\fR instruction appears in the \fICFG_\fIdevice_name\fR\fR
file, or if the issuer of the \fBbutc\fR command included the \fB\-noautoquery\fR
flag, the Tape Coordinator instead expects the tape to be in the device
already.  If it is not, the Tape Coordinator invokes the \f(CWMOUNT\fR
instruction or prompts the operator.
.SH "OPTIONS"
.Ip "\fB\-name\fR <\fI\s-1AFS\s0 tape name\fR>" 4
Specifies the \s-1AFS\s0 tape name to record on the label. Include this argument
or the \fB\-pname\fR argument, but not both. If this argument is omitted, the
\s-1AFS\s0 tape name is set to \f(CW< <NULL\fR >>.  If this argument is provided, it
must have the following format:
.Sp
.Vb 1
\&   <volume_set_name>.<dump_level_name>.<tape_index>
.Ve
for the tape to be acceptable for use in a future backup dump
operation. The <volume_set_name> must match the volume set name of the
initial dump to be written to the tape, <dump_level_name> must match the
last element of the dump level pathname at which the volume set will be
dumped, and <tape_index> indicates the order of the tape in the dump set
(indexing begins with \f(CW1\fR). To disable this type of name checking,
include the \f(CWNAME_CHECK NO\fR instruction in the \fI\s-1CFG_\s0\fIdevice_name\fR\fR
file.
.Sp
For the tape to be acceptable for use in a future backup savedb operation,
the value specified for the \fB\-name\fR argument must have the following
format:
.Sp
.Vb 1
\&   Ubik_db_dump.<tape_index>
.Ve
where <tape_index> indicates the order of the tape in the set of tapes
that house the Backup Database dump; indexing begins with \f(CW1\fR (one).
.Ip "\fB\-size\fR <\fItape size\fR>" 4
Specifies the tape capacity to record on the label. Provide an integer
value followed by a letter that indicates units, with no intervening
space. A unit value of \f(CWk\fR or \f(CWK\fR indicates kilobytes, \f(CWm\fR or \f(CWM\fR
indicates megabytes, and \f(CWg\fR or \f(CWG\fR indicates gigabytes. If the units
letter is omitted, the default is kilobytes.
.Sp
If this argument is omitted the first time a tape is labeled, the Backup
System records the capacity that is associated with the specified port
offset in the \fI/usr/afs/backup/tapeconfig\fR file on the Tape Coordinator
machine. The value recorded the first time then persists until the
\fB\-size\fR argument is provided on a future issuance of the command.
.Ip "\fB\-portoffset\fR <\fI\s-1TC\s0 port offset\fR>" 4
Specifies the port offset number of the Tape Coordinator handling the tape
for this operation.
.Ip "\fB\-pname\fR <\fIpermanent tape name\fR>" 4
Specifies the permanent name to record on the label. It can be up to 32
characters in length, and include any alphanumeric characters.  Avoid
metacharacters that have a special meaning to the shell, to avoid having
to mark them as literal in commands issued at the shell prompt.
.Sp
Include this argument or the \fB\-name\fR argument, but not both. If this
argument is provided, the \s-1AFS\s0 tape name is set to \f(CW< <NULL\fR >>. If this
argument is omitted, any existing permanent name is retained.
.Ip "\fB\-localauth\fR" 4
Constructs a server ticket using a key from the local
\fI/usr/afs/etc/KeyFile\fR file. The \fBbackup\fR command interpreter presents
it to the Backup Server, Volume Server and \s-1VL\s0 Server during mutual
authentication. Do not combine this flag with the \fB\-cell\fR argument. For
more details, see the \fIbackup(8)\fR manpage.
.Ip "\fB\-cell\fR <\fIcell name\fR>" 4
Names the cell in which to run the command. Do not combine this argument
with the \fB\-localauth\fR flag. For more details, see the \fIbackup(8)\fR manpage.
.Ip "\fB\-help\fR" 4
Prints the online help for this command. All other valid options are
ignored.
.SH "EXAMPLES"
The following command records the AFS tape name \f(CWuser.monthly.1\fR on the
label of the tape in the device with port offset 3:
.PP
.Vb 1
\&   % backup labeltape -name user.monthly.1 -portoffset 3
.Ve
The following three commands are equivalent in effect: they all record a
capacity of 2 GB on the label of the tape in the device with port offset
4. They set the AFS tape name to \f(CW< <NULL\fR >> and leave the permanent
name unchanged.
.PP
.Vb 3
\&   % backup labeltape -size 2g -portoffset 4
\&   % backup labeltape -size 2048M -portoffset 4
\&   % backup labeltape -size 2097152 -portoffset 4
.Ve
.SH "PRIVILEGE REQUIRED"
The issuer must be listed in the \fI/usr/afs/etc/UserList\fR file on every
machine where the Backup Server is running, or must be logged onto a
server machine as the local superuser \f(CWroot\fR if the \fB\-localauth\fR flag is
included.
.SH "SEE ALSO"
the \fIbutc(5)\fR manpage,
the \fIbackup(8)\fR manpage,
the \fIbackup_readlabel(8)\fR manpage,
the \fIbutc(8)\fR manpage
.SH "COPYRIGHT"
IBM Corporation 2000. <http://www.ibm.com/> All Rights Reserved.
.PP
This documentation is covered by the IBM Public License Version 1.0.  It was
converted from HTML to POD by software written by Chas Williams and Russ
Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.

.rn }` ''
.IX Title "backup_labeltape 8"
.IX Name "backup labeltape - Creates the magnetic label on a tape"

.IX Header "NAME"

.IX Header "SYNOPSIS"

.IX Header "DESCRIPTION"

.IX Header "OPTIONS"

.IX Item "\fB\-name\fR <\fI\s-1AFS\s0 tape name\fR>"

.IX Item "\fB\-size\fR <\fItape size\fR>"

.IX Item "\fB\-portoffset\fR <\fI\s-1TC\s0 port offset\fR>"

.IX Item "\fB\-pname\fR <\fIpermanent tape name\fR>"

.IX Item "\fB\-localauth\fR"

.IX Item "\fB\-cell\fR <\fIcell name\fR>"

.IX Item "\fB\-help\fR"

.IX Header "EXAMPLES"

.IX Header "PRIVILEGE REQUIRED"

.IX Header "SEE ALSO"

.IX Header "COPYRIGHT"

