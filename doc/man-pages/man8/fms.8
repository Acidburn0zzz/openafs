.rn '' }`
''' $RCSfile$$Revision$$Date$
'''
''' $Log$
'''
.de Sh
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp
.if t .sp .5v
.if n .sp
..
.de Ip
.br
.ie \\n(.$>=3 .ne \\$3
.el .ne 3
.IP "\\$1" \\$2
..
.de Vb
.ft CW
.nf
.ne \\$1
..
.de Ve
.ft R

.fi
..
'''
'''
'''     Set up \*(-- to give an unbreakable dash;
'''     string Tr holds user defined translation string.
'''     Bell System Logo is used as a dummy character.
'''
.tr \(*W-|\(bv\*(Tr
.ie n \{\
.ds -- \(*W-
.ds PI pi
.if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\" diablo 12 pitch
.ds L" ""
.ds R" ""
'''   \*(M", \*(S", \*(N" and \*(T" are the equivalent of
'''   \*(L" and \*(R", except that they are used on ".xx" lines,
'''   such as .IP and .SH, which do another additional levels of
'''   double-quote interpretation
.ds M" """
.ds S" """
.ds N" """""
.ds T" """""
.ds L' '
.ds R' '
.ds M' '
.ds S' '
.ds N' '
.ds T' '
'br\}
.el\{\
.ds -- \(em\|
.tr \*(Tr
.ds L" ``
.ds R" ''
.ds M" ``
.ds S" ''
.ds N" ``
.ds T" ''
.ds L' `
.ds R' '
.ds M' `
.ds S' '
.ds N' `
.ds T' '
.ds PI \(*p
'br\}
.\"	If the F register is turned on, we'll generate
.\"	index entries out stderr for the following things:
.\"		TH	Title 
.\"		SH	Header
.\"		Sh	Subsection 
.\"		Ip	Item
.\"		X<>	Xref  (embedded
.\"	Of course, you have to process the output yourself
.\"	in some meaninful fashion.
.if \nF \{
.de IX
.tm Index:\\$1\t\\n%\t"\\$2"
..
.nr % 0
.rr F
.\}
.TH fms 8 "OpenAFS" "1/Mar/2006" "AFS Command Reference"
.UC
.if n .hy 0
.if n .na
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.de CQ          \" put $1 in typewriter font
.ft CW
'if n "\c
'if t \\&\\$1\c
'if n \\&\\$1\c
'if n \&"
\\&\\$2 \\$3 \\$4 \\$5 \\$6 \\$7
'.ft R
..
.\" @(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2
.	\" AM - accent mark definitions
.bd B 3
.	\" fudge factors for nroff and troff
.if n \{\
.	ds #H 0
.	ds #V .8m
.	ds #F .3m
.	ds #[ \f1
.	ds #] \fP
.\}
.if t \{\
.	ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.	ds #V .6m
.	ds #F 0
.	ds #[ \&
.	ds #] \&
.\}
.	\" simple accents for nroff and troff
.if n \{\
.	ds ' \&
.	ds ` \&
.	ds ^ \&
.	ds , \&
.	ds ~ ~
.	ds ? ?
.	ds ! !
.	ds /
.	ds q
.\}
.if t \{\
.	ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.	ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.	ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.	ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.	ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.	ds ? \s-2c\h'-\w'c'u*7/10'\u\h'\*(#H'\zi\d\s+2\h'\w'c'u*8/10'
.	ds ! \s-2\(or\s+2\h'-\w'\(or'u'\v'-.8m'.\v'.8m'
.	ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.	ds q o\h'-\w'o'u*8/10'\s-4\v'.4m'\z\(*i\v'-.4m'\s+4\h'\w'o'u*8/10'
.\}
.	\" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds v \\k:\h'-(\\n(.wu*9/10-\*(#H)'\v'-\*(#V'\*(#[\s-4v\s0\v'\*(#V'\h'|\\n:u'\*(#]
.ds _ \\k:\h'-(\\n(.wu*9/10-\*(#H+(\*(#F*2/3))'\v'-.4m'\z\(hy\v'.4m'\h'|\\n:u'
.ds . \\k:\h'-(\\n(.wu*8/10)'\v'\*(#V*4/10'\z.\v'-\*(#V*4/10'\h'|\\n:u'
.ds 3 \*(#[\v'.2m'\s-2\&3\s0\v'-.2m'\*(#]
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.ds oe o\h'-(\w'o'u*4/10)'e
.ds Oe O\h'-(\w'O'u*4/10)'E
.	\" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.	\" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.	ds : e
.	ds 8 ss
.	ds v \h'-1'\o'\(aa\(ga'
.	ds _ \h'-1'^
.	ds . \h'-1'.
.	ds 3 3
.	ds o a
.	ds d- d\h'-1'\(ga
.	ds D- D\h'-1'\(hy
.	ds th \o'bp'
.	ds Th \o'LP'
.	ds ae ae
.	ds Ae AE
.	ds oe oe
.	ds Oe OE
.\}
.rm #[ #] #H #V #F C
.SH "NAME"
fms \- Determine a tape's capacity and a tape device's filemark size
.SH "SYNOPSIS"
\fBfms\fR <<\ \fB\-tape\fR\ <\fItape\ special\ file\fR >>> [\fB\-help\fR]
.PP
\fBfms\fR <<\ \fB\-t\fR\ <\fItape\ special\ file\fR >>> [\fB\-h\fR]
.SH "DESCRIPTION"
The \fBfms\fR command determines the capacity of the tape currently in the
tape device identified by the \fB\-tape\fR argument, along with the size of
the filemark for the device. The filemark is also referred to as the
device's end-of-file (EOF) marker, and can differ for each combination of
tape and tape device.
.PP
As the Tape Coordinator writes a dump, it writes a filemark between the
data included from each volume and also tracks the amount of space left
before the end of the tape (EOT). For some tape devices, the filemark is
large enough (multiple megabytes) that failure to consider it leads the
Tape Coordinator significantly to overestimate the available space.
.PP
The intended use of this command is to determine tape capacity and
filemark size values that can be specified in a tape device's entry in the
\fI/usr/afs/backup/tapeconfig\fR file. For certain types of tape drives, the
Tape Coordinator operates more efficiently when the \fItapeconfig\fR file
lists accurate values. For further discussion, see the \fIIBM AFS
Administration Guide\fR chapter on configuring the Backup System.
.PP
Insert a tape in the drive before issuing this command.
.SH "CAUTIONS"
Do not use this command on compressing tape devices in compression mode or
with tape devices that handle tapes of multigigabyte (or multiterabyte)
capacity. It does not produce accurate results in those cases.  For
alternate suggestions on the values to record in the \fBtapeconfig\fR file
for compressing drives, see the \fIIBM AFS Administration Guide\fR chapter on
configuring the Backup System.
.PP
Running the command completely overwrites the tape, so use a blank one or
one that can be recycled.
.PP
Because it writes filemarks to the complete length of the tape, the
command can take from several hours to more than a day to complete.
.SH "OPTIONS"
.Ip "\fB\-tape\fR <\fItape special file\fR>" 4
Specifies the \s-1UNIX\s0 device name of the tape device for which to determine
filemark size and the capacity of the tape it currently contains. The
format varies on different system types, but usually begins with \fI/dev\fR;
an example is \fI/dev/sd0a\fR.
.Ip "\fB\-help\fR" 4
Prints the online help for this command. All other valid options are
ignored.
.SH "OUTPUT"
The command generates output both on the standard output stream and in the
\fIfms.log\fR file that it creates in the current working directory. The
output reports the capacity of the tape in the device and the device's
filemark size.
.PP
The first few lines of output include status information about the
execution of the command, including such information as the number of
blocks and the number of file marks written to the tape by the
command. The last two lines of both screen and file output provide the
following information:
.Ip "\(bu" 4
\f(CWTape capacity is \fInumber\fR bytes\fR: specifies the size, in bytes, of the
tape in the device.
.Ip "\(bu" 4
\f(CWFile marks are \fInumber\fR bytes\fR: specifies the device's filemark size in
bytes.
.PP
The following message indicates that the fms command interpreter cannot
access the tape device. The command halts.
.PP
.Vb 1
\&   Can't open tape drive I<device>
.Ve
The following message indicates that the command interpreter cannot create
the \fIfms.log\fR log file. Again, the command halts.
.PP
.Vb 1
\&   Can't open log file
.Ve
.SH "EXAMPLES"
The following command illustrates the output for the device called
\fI/dev/rmt1h\fR:
.PP
.Vb 7
\&   % fms /dev/rmt1h
\&   wrote block: 130408
\&   Finished data capacity test - rewinding
\&   wrote 1109 blocks, 1109 file marks
\&   Finished file mark test
\&   Tape capacity is 2136604672 bytes
\&   File marks are 1910205 bytes
.Ve
The following appears in the \fIfms.log\fR file:
.PP
.Vb 5
\&   fms test started
\&   wrote 9230 blocks
\&   Finished file mark test
\&   Tape capacity is 151224320 bytes
\&   File marks are 2375680 bytes
.Ve
.SH "PRIVILEGE REQUIRED"
The issuer must be able to insert and write to files in the currently
working directory, if the \fIfms.log\fR file does not already exist. If it
already exists, the issuer need only be able to write to it.
.SH "SEE ALSO"
the \fIfms.log(5)\fR manpage,
the \fItapeconfig(5)\fR manpage
.SH "COPYRIGHT"
IBM Corporation 2000. <http://www.ibm.com/> All Rights Reserved.
.PP
This documentation is covered by the IBM Public License Version 1.0.  It was
converted from HTML to POD by software written by Chas Williams and Russ
Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.

.rn }` ''
.IX Title "fms 8"
.IX Name "fms - Determine a tape's capacity and a tape device's filemark size"

.IX Header "NAME"

.IX Header "SYNOPSIS"

.IX Header "DESCRIPTION"

.IX Header "CAUTIONS"

.IX Header "OPTIONS"

.IX Item "\fB\-tape\fR <\fItape special file\fR>"

.IX Item "\fB\-help\fR"

.IX Header "OUTPUT"

.IX Item "\(bu"

.IX Item "\(bu"

.IX Header "EXAMPLES"

.IX Header "PRIVILEGE REQUIRED"

.IX Header "SEE ALSO"

.IX Header "COPYRIGHT"

