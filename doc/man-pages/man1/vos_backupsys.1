.rn '' }`
''' $RCSfile$$Revision$$Date$
'''
''' $Log$
'''
.de Sh
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp
.if t .sp .5v
.if n .sp
..
.de Ip
.br
.ie \\n(.$>=3 .ne \\$3
.el .ne 3
.IP "\\$1" \\$2
..
.de Vb
.ft CW
.nf
.ne \\$1
..
.de Ve
.ft R

.fi
..
'''
'''
'''     Set up \*(-- to give an unbreakable dash;
'''     string Tr holds user defined translation string.
'''     Bell System Logo is used as a dummy character.
'''
.tr \(*W-|\(bv\*(Tr
.ie n \{\
.ds -- \(*W-
.ds PI pi
.if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\" diablo 12 pitch
.ds L" ""
.ds R" ""
'''   \*(M", \*(S", \*(N" and \*(T" are the equivalent of
'''   \*(L" and \*(R", except that they are used on ".xx" lines,
'''   such as .IP and .SH, which do another additional levels of
'''   double-quote interpretation
.ds M" """
.ds S" """
.ds N" """""
.ds T" """""
.ds L' '
.ds R' '
.ds M' '
.ds S' '
.ds N' '
.ds T' '
'br\}
.el\{\
.ds -- \(em\|
.tr \*(Tr
.ds L" ``
.ds R" ''
.ds M" ``
.ds S" ''
.ds N" ``
.ds T" ''
.ds L' `
.ds R' '
.ds M' `
.ds S' '
.ds N' `
.ds T' '
.ds PI \(*p
'br\}
.\"	If the F register is turned on, we'll generate
.\"	index entries out stderr for the following things:
.\"		TH	Title 
.\"		SH	Header
.\"		Sh	Subsection 
.\"		Ip	Item
.\"		X<>	Xref  (embedded
.\"	Of course, you have to process the output yourself
.\"	in some meaninful fashion.
.if \nF \{
.de IX
.tm Index:\\$1\t\\n%\t"\\$2"
..
.nr % 0
.rr F
.\}
.TH VOS_BACKUPSYS 1 "OpenAFS" "1/Mar/2006" "AFS Command Reference"
.UC
.if n .hy 0
.if n .na
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.de CQ          \" put $1 in typewriter font
.ft CW
'if n "\c
'if t \\&\\$1\c
'if n \\&\\$1\c
'if n \&"
\\&\\$2 \\$3 \\$4 \\$5 \\$6 \\$7
'.ft R
..
.\" @(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2
.	\" AM - accent mark definitions
.bd B 3
.	\" fudge factors for nroff and troff
.if n \{\
.	ds #H 0
.	ds #V .8m
.	ds #F .3m
.	ds #[ \f1
.	ds #] \fP
.\}
.if t \{\
.	ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.	ds #V .6m
.	ds #F 0
.	ds #[ \&
.	ds #] \&
.\}
.	\" simple accents for nroff and troff
.if n \{\
.	ds ' \&
.	ds ` \&
.	ds ^ \&
.	ds , \&
.	ds ~ ~
.	ds ? ?
.	ds ! !
.	ds /
.	ds q
.\}
.if t \{\
.	ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.	ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.	ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.	ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.	ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.	ds ? \s-2c\h'-\w'c'u*7/10'\u\h'\*(#H'\zi\d\s+2\h'\w'c'u*8/10'
.	ds ! \s-2\(or\s+2\h'-\w'\(or'u'\v'-.8m'.\v'.8m'
.	ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.	ds q o\h'-\w'o'u*8/10'\s-4\v'.4m'\z\(*i\v'-.4m'\s+4\h'\w'o'u*8/10'
.\}
.	\" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds v \\k:\h'-(\\n(.wu*9/10-\*(#H)'\v'-\*(#V'\*(#[\s-4v\s0\v'\*(#V'\h'|\\n:u'\*(#]
.ds _ \\k:\h'-(\\n(.wu*9/10-\*(#H+(\*(#F*2/3))'\v'-.4m'\z\(hy\v'.4m'\h'|\\n:u'
.ds . \\k:\h'-(\\n(.wu*8/10)'\v'\*(#V*4/10'\z.\v'-\*(#V*4/10'\h'|\\n:u'
.ds 3 \*(#[\v'.2m'\s-2\&3\s0\v'-.2m'\*(#]
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.ds oe o\h'-(\w'o'u*4/10)'e
.ds Oe O\h'-(\w'O'u*4/10)'E
.	\" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.	\" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.	ds : e
.	ds 8 ss
.	ds v \h'-1'\o'\(aa\(ga'
.	ds _ \h'-1'^
.	ds . \h'-1'.
.	ds 3 3
.	ds o a
.	ds d- d\h'-1'\(ga
.	ds D- D\h'-1'\(hy
.	ds th \o'bp'
.	ds Th \o'LP'
.	ds ae ae
.	ds Ae AE
.	ds oe oe
.	ds Oe OE
.\}
.rm #[ #] #H #V #F C
.SH "NAME"
vos backupsys \- Creates a backup volume for several read/write volumes
.SH "SYNOPSIS"
\fBvos backupsys\fR <<\ [\fB\-prefix\fR\ <\fIcommon\ prefix\ on\ volume(s)\fR+] >>>
    <<\ [\fB\-server\fR\ <\fImachine\ name\fR] >>> <<\ [\fB\-partition\fR\ <\fIpartition\ name\fR] >>>
    [\fB\-exclude\fR] <<\ [\fB\-xprefix\fR\ <\fInegative\ prefix\ on\ volume(s)\fR+] >>>
    [\fB\-dryrun\fR] <<\ [\fB\-cell\fR\ <\fIcell\ name\fR] >>> [\fB\-noauth\fR] [\fB\-localauth\fR]
    [\fB\-verbose\fR] [\fB\-help\fR]
.PP
\fBvos backups\fR <<\ [\fB\-pr\fR\ <\fIcommon\ prefix\ on\ volume(s)\fR+] >>>
    <<\ [\fB\-s\fR\ <\fImachine\ name\fR] >>> <<\ [\fB\-pa\fR\ <\fIpartition\ name\fR] >>> [\fB\-e\fR]
    <<\ [\fB\-x\fR\ <\fInegative\ prefix\ on\ volume(s)\fR+] >>> [\fB\-d\fR]
    <<\ [\fB\-c\fR\ <\fIcell\ name\fR] >>> [\fB\-n\fR] [\fB\-l\fR] [\fB\-v\fR] [\fB\-h\fR]
.SH "DESCRIPTION"
The \fBvos backupsys\fR command clones each indicated read/write volume to
create a backup version, placing each clone at the same site as its
read/write source version. It assigns each clone the same name as the
read/write source, adding a \f(CW.backup\fR extension. It assigns the volume ID
number already allocated for the backup version in the Volume Location
Database (VLDB). If a backup version already exists for a given volume,
the new clone replaces it.
.PP
To clone every read/write volume listed in the VLDB, omit all of the
command's options. Otherwise, combine the command's options to clone
various groups of volumes. The options use one of two basic criteria to
select volumes: location (the \fB\-server\fR and \fB\-partition\fR arguments) or
presence in the volume name of one of a set of specified character strings
(the \fB\-prefix\fR, \fB\-exclude\fR, and \fB\-xprefix\fR options).
.PP
To clone only volumes that reside on one file server machine, include the
\fB\-server\fR argument. To clone only volumes that reside on one partition,
combine the \fB\-server\fR and \fB\-partition\fR arguments. The \fB\-partition\fR
argument can also be used alone to clone volumes that reside on the
indicated partition on every file server machine. These arguments can be
combined with those that select volumes based on their names.
.PP
Combine the \fB\-prefix\fR, \-exclude, and \fB\-xprefix\fR options (with or without
the \fB\-server\fR and \fB\-partition\fR arguments) in the indicated ways to
select volumes based on character strings contained in their names:
.Ip "\(bu" 4
To clone every read/write volume at the specified location whose name
includes one of a set of specified character strings (for example, begins
with \f(CWuser.\fR or includes the string \f(CWafs\fR), use the \fB\-prefix\fR argument
or combine the \fB\-xprefix\fR and \fB\-exclude\fR options.
.Ip "\(bu" 4
To clone every read/write volume at the specified location except those
whose name includes one of a set of specified character strings, use the
\fB\-xprefix\fR argument or combine the \fB\-prefix\fR and \fB\-exclude\fR options.
.Ip "\(bu" 4
To clone every read/write volume at the specified location whose name
includes one of one of a set of specified character strings, except those
whose names include one of a different set of specified character strings,
combine the \fB\-prefix\fR and \fB\-xprefix\fR arguments. The command creates a
list of all volumes that match the \fB\-prefix\fR argument and then removes
from the list the volumes that match the \fB\-xprefix\fR argument. For
effective results, the strings specified by the \fB\-xprefix\fR argument must
designate a subset of the volumes specified by the \fB\-prefix\fR argument.
.Sp
If the \fB\-exclude\fR flag is combined with the \fB\-prefix\fR and \fB\-xprefix\fR
arguments, the command creates a list of all volumes that do not match the
\fB\-prefix\fR argument and then adds to the list any volumes that match the
\fB\-xprefix\fR argument. As when the \fB\-exclude\fR flag is not used, the result
is effective only if the strings specified by the \fB\-xprefix\fR argument
designate a subset of the volumes specified by the \fB\-prefix\fR argument.
.PP
The \fB\-prefix\fR and \fB\-xprefix\fR arguments both accept multiple values,
which can be used to define disjoint groups of volumes. Each value can be
one of two types:
.Ip "\(bu" 4
A simple character string, which matches volumes whose name begin with the
string. All characters are interpreted literally (that is, characters that
potentially have special meaning to the command shell, such as the period,
have only their literal meaning).
.Ip "\(bu" 4
A regular expression, which matches volumes whose names contain the
expressions. Place a caret (\f(CW^\fR) at the beginning of the expression, and
enclose the entire string in single quotes (\f(CW''\fR). Explaining regular
expressions is outside the scope of this reference page; see the \s-1UNIX\s0
manual page for \fIregexp\fR\|(5) or (for a brief introduction)
the \fIbackup_addvolentry(8)\fR manpage. As an example, the following expression matches
volumes that have the string \f(CWaix\fR anywhere in their names:
.Sp
.Vb 1
\&   -prefix  '^.*aix'
.Ve
.PP
To display a list of the volumes to be cloned, without actually cloning
them, include the \fB\-dryrun\fR flag. To display a statement that summarizes
the criteria being used to select volume, include the \fB\-verbose\fR flag.
.PP
This command can be used to clone a single read/write volume; specify its
complete name as the \fB\-prefix\fR argument. However, it is more efficient to
use the \fBvos backup\fR command, which employs a more streamlined technique
for finding a single volume.
.SH "OPTIONS"
.Ip "\fB\-prefix\fR <\fIcommon prefix\fR>" 4
Specifies one or more simple character strings or regular expressions of
any length; a volume whose name includes the string is placed on the set
of volumes to be cloned. Include field separators (such as periods) if
appropriate. This argument can be combined with any combination of the
\fB\-server\fR, \fB\-partition\fR, \fB\-exclude\fR, and \fB\-xprefix\fR options.
.Ip "\fB\-server\fR <\fImachine name\fR>" 4
Identifies the file server machine where each read/write source volume
resides. Provide the machine's \s-1IP\s0 address or its host name (either fully
qualified or using an unambiguous abbreviation). For details, see
the \fIvos(1)\fR manpage.
.Sp
This argument can be combined with any combination of the \fB\-prefix\fR,
\fB\-partition\fR, \fB\-exclude\fR, and \fB\-xprefix\fR options.
.Ip "\fB\-partition\fR <\fIpartition name\fR>" 4
Identifies the partition where each read/write source volume
resides. Provide the partition's complete name with preceding slash (for
example, \f(CW/vicepa\fR) or use one of the three acceptable abbreviated
forms. For details, see the \fIvos(1)\fR manpage.
.Sp
This argument can be combined with any combination of the \fB\-prefix\fR,
\fB\-server\fR, \fB\-exclude\fR, and \fB\-xprefix\fR options.
.Ip "\fB\-exclude\fR" 4
Reverses the meaning of the \fB\-prefix\fR or \fB\-xprefix\fR argument. This flag
can be combined with any combination of the \fB\-prefix\fR, \fB\-server\fR,
\fB\-partition\fR, and \fB\-xprefix\fR options.
.Ip "\fB\-xprefix\fR <\fInegative prefix\fR>" 4
Specifies a simple character string or regular expression of any length; a
volume whose name includes the string is removed from the set of volumes
to be cloned. Include field separators (such as periods) if
appropriate. This argument can be combined with any combination of the
\fB\-prefix\fR, \fB\-server\fR, \fB\-partition\fR, and \fB\-exclude\fR options.
.Ip "\fB\-dryrun\fR" 4
Displays on the standard output stream a list of the volumes to be cloned,
without actually cloning them.
.Ip "\fB\-cell\fR <\fIcell name\fR>" 4
Names the cell in which to run the command. Do not combine this argument
with the \fB\-localauth\fR flag. For more details, see the \fIvos(1)\fR manpage.
.Ip "\fB\-noauth\fR" 4
Assigns the unprivileged identity \f(CWanonymous\fR to the issuer. Do not
combine this flag with the \fB\-localauth\fR flag. For more details, see
the \fIvos(1)\fR manpage.
.Ip "\fB\-localauth\fR" 4
Constructs a server ticket using a key from the local
\fI/usr/afs/etc/KeyFile\fR file. The \fBvos\fR command interpreter presents it
to the Volume Server and Volume Location Server during mutual
authentication. Do not combine this flag with the \fB\-cell\fR argument or
\fB\-noauth\fR flag. For more details, see the \fIvos(1)\fR manpage.
.Ip "\fB\-verbose\fR" 4
Produces on the standard output stream a detailed trace of the command's
execution. If this argument is omitted, only warnings and error messages
appear.
.Ip "\fB\-help\fR" 4
Prints the online help for this command. All other valid options are
ignored.
.SH "OUTPUT"
The command generates the following messages on the standard output stream
to confirm that the operation was successful:
.PP
.Vb 2
\&   done
\&   Total volumes backed up: <number_cloned>; failed to backup: <failures>
.Ve
If the \fB\-dryrun\fR flag is included, a list of the volumes to be backed up
precedes the standard confirmation messages.
.PP
If the \fB\-verbose\fR flag is included but not the \fB\-dryrun\fR flag, the
following messages appear for each volume. The output concludes with the
standard confirmation messages.
.PP
.Vb 2
\&   Creating backup volume for <volume_name> on <date/time>
\&   {Recloning backup volume | Creating a new backup clone} <backup_volumeID> . . .done
.Ve
If both the \fB\-dryrun\fR and \fB\-verbose\fR flags are included, the output
begins with a statement summarizing the criteria being used to select the
volumes, followed by a list of the volumes and the standard confirmation
messages. The format of the criteria summary statement depends on which
other options are provided:
.Ip "\(bu" 4
If only the \fB\-prefix\fR argument is provided, or the \fB\-xprefix\fR and
\fB\-exclude\fR options are combined:
.Sp
.Vb 1
\&   Would have backed up volumes which are prefixed with <string> [or <string>] . .
.Ve
.Ip "\(bu" 4
If only the \fB\-xprefix\fR argument is provided, or the \fB\-prefix\fR and
\fB\-exclude\fR options are combined:
.Sp
.Vb 1
\&   Would have backed up volumes which are not prefixed with <string> [nor <string>] . .
.Ve
.Ip "\(bu" 4
If the \fB\-prefix\fR and \fB\-xprefix\fR arguments are combined:
.Sp
.Vb 2
\&   Would have backed up volumes which are prefixed with <string> [or <string>] \e
\&      removing those which are prefixed with <x_string> [or <x_string>] . .
.Ve
.Ip "\(bu" 4
If the \fB\-prefix\fR, \fB\-xprefix\fR, and \fB\-exclude\fR options are provided:
.Sp
.Vb 2
\&   Would have backed up volumes which are not prefixed with <string> [nor <string>] \e
\&      adding those which are prefixed with <x_string> [or <x_string>] . .
.Ve
.SH "EXAMPLES"
The following example creates a backup version of every read/write volume
listed in the cell's VLDB whose name begins with the string \fBuser\fR.
.PP
.Vb 1
\&   % vos backupsys -prefix user
.Ve
The following example, appropriate in the ABC Corporation cell, creates a
backup version of every read/write volume on the file server machine
\f(CWfs3.abc.com\fR.
.PP
.Vb 1
\&   % vos backupsys -server fs3.abc.com
.Ve
The following example, appropriate in the State University cell, creates a
backup version of every read/write volume on the file server machine
\f(CWdb1.stateu.edu\fR except those whose name includes the string \f(CWtemp\fR.
.PP
.Vb 1
\&   % vos backupsys  -server db1.stateu.edu -prefix '^.*temp'
.Ve
The following example creates a backup version of every volume listed in
the cell's VLDB, excluding those whose names contain the string \f(CWsource\fR,
but including those whose names contain the string \f(CWsource.current\fR.
.PP
.Vb 1
\&   % vos backupsys  -prefix '^.*source' -exclude -xprefix '^.*source\e.current'
.Ve
.SH "PRIVILEGE REQUIRED"
The issuer must be listed in the \fI/usr/afs/etc/UserList\fR file on the
machine specified with the \fB\-server\fR argument and on each database server
machine. If the \fB\-localauth\fR flag is included, the issuer must instead be
logged on to a server machine as the local superuser \f(CWroot\fR.
.SH "SEE ALSO"
the \fIbackup_addvolentry(8)\fR manpage,
the \fIvos(1)\fR manpage,
the \fIvos_backup(1)\fR manpage
.PP
UNIX manual page for \fIregexp\fR\|(5)
.SH "COPYRIGHT"
IBM Corporation 2000. <http://www.ibm.com/> All Rights Reserved.
.PP
This documentation is covered by the IBM Public License Version 1.0.  It was
converted from HTML to POD by software written by Chas Williams and Russ
Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.

.rn }` ''
.IX Title "VOS_BACKUPSYS 1"
.IX Name "vos backupsys - Creates a backup volume for several read/write volumes"

.IX Header "NAME"

.IX Header "SYNOPSIS"

.IX Header "DESCRIPTION"

.IX Item "\(bu"

.IX Item "\(bu"

.IX Item "\(bu"

.IX Item "\(bu"

.IX Item "\(bu"

.IX Header "OPTIONS"

.IX Item "\fB\-prefix\fR <\fIcommon prefix\fR>"

.IX Item "\fB\-server\fR <\fImachine name\fR>"

.IX Item "\fB\-partition\fR <\fIpartition name\fR>"

.IX Item "\fB\-exclude\fR"

.IX Item "\fB\-xprefix\fR <\fInegative prefix\fR>"

.IX Item "\fB\-dryrun\fR"

.IX Item "\fB\-cell\fR <\fIcell name\fR>"

.IX Item "\fB\-noauth\fR"

.IX Item "\fB\-localauth\fR"

.IX Item "\fB\-verbose\fR"

.IX Item "\fB\-help\fR"

.IX Header "OUTPUT"

.IX Item "\(bu"

.IX Item "\(bu"

.IX Item "\(bu"

.IX Item "\(bu"

.IX Header "EXAMPLES"

.IX Header "PRIVILEGE REQUIRED"

.IX Header "SEE ALSO"

.IX Header "COPYRIGHT"

