.rn '' }`
''' $RCSfile$$Revision$$Date$
'''
''' $Log$
'''
.de Sh
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp
.if t .sp .5v
.if n .sp
..
.de Ip
.br
.ie \\n(.$>=3 .ne \\$3
.el .ne 3
.IP "\\$1" \\$2
..
.de Vb
.ft CW
.nf
.ne \\$1
..
.de Ve
.ft R

.fi
..
'''
'''
'''     Set up \*(-- to give an unbreakable dash;
'''     string Tr holds user defined translation string.
'''     Bell System Logo is used as a dummy character.
'''
.tr \(*W-|\(bv\*(Tr
.ie n \{\
.ds -- \(*W-
.ds PI pi
.if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\" diablo 12 pitch
.ds L" ""
.ds R" ""
'''   \*(M", \*(S", \*(N" and \*(T" are the equivalent of
'''   \*(L" and \*(R", except that they are used on ".xx" lines,
'''   such as .IP and .SH, which do another additional levels of
'''   double-quote interpretation
.ds M" """
.ds S" """
.ds N" """""
.ds T" """""
.ds L' '
.ds R' '
.ds M' '
.ds S' '
.ds N' '
.ds T' '
'br\}
.el\{\
.ds -- \(em\|
.tr \*(Tr
.ds L" ``
.ds R" ''
.ds M" ``
.ds S" ''
.ds N" ``
.ds T" ''
.ds L' `
.ds R' '
.ds M' `
.ds S' '
.ds N' `
.ds T' '
.ds PI \(*p
'br\}
.\"	If the F register is turned on, we'll generate
.\"	index entries out stderr for the following things:
.\"		TH	Title 
.\"		SH	Header
.\"		Sh	Subsection 
.\"		Ip	Item
.\"		X<>	Xref  (embedded
.\"	Of course, you have to process the output yourself
.\"	in some meaninful fashion.
.if \nF \{
.de IX
.tm Index:\\$1\t\\n%\t"\\$2"
..
.nr % 0
.rr F
.\}
.TH KPASSWD 1 "OpenAFS" "1/Mar/2006" "AFS Command Reference"
.UC
.if n .hy 0
.if n .na
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.de CQ          \" put $1 in typewriter font
.ft CW
'if n "\c
'if t \\&\\$1\c
'if n \\&\\$1\c
'if n \&"
\\&\\$2 \\$3 \\$4 \\$5 \\$6 \\$7
'.ft R
..
.\" @(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2
.	\" AM - accent mark definitions
.bd B 3
.	\" fudge factors for nroff and troff
.if n \{\
.	ds #H 0
.	ds #V .8m
.	ds #F .3m
.	ds #[ \f1
.	ds #] \fP
.\}
.if t \{\
.	ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.	ds #V .6m
.	ds #F 0
.	ds #[ \&
.	ds #] \&
.\}
.	\" simple accents for nroff and troff
.if n \{\
.	ds ' \&
.	ds ` \&
.	ds ^ \&
.	ds , \&
.	ds ~ ~
.	ds ? ?
.	ds ! !
.	ds /
.	ds q
.\}
.if t \{\
.	ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.	ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.	ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.	ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.	ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.	ds ? \s-2c\h'-\w'c'u*7/10'\u\h'\*(#H'\zi\d\s+2\h'\w'c'u*8/10'
.	ds ! \s-2\(or\s+2\h'-\w'\(or'u'\v'-.8m'.\v'.8m'
.	ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.	ds q o\h'-\w'o'u*8/10'\s-4\v'.4m'\z\(*i\v'-.4m'\s+4\h'\w'o'u*8/10'
.\}
.	\" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds v \\k:\h'-(\\n(.wu*9/10-\*(#H)'\v'-\*(#V'\*(#[\s-4v\s0\v'\*(#V'\h'|\\n:u'\*(#]
.ds _ \\k:\h'-(\\n(.wu*9/10-\*(#H+(\*(#F*2/3))'\v'-.4m'\z\(hy\v'.4m'\h'|\\n:u'
.ds . \\k:\h'-(\\n(.wu*8/10)'\v'\*(#V*4/10'\z.\v'-\*(#V*4/10'\h'|\\n:u'
.ds 3 \*(#[\v'.2m'\s-2\&3\s0\v'-.2m'\*(#]
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.ds oe o\h'-(\w'o'u*4/10)'e
.ds Oe O\h'-(\w'O'u*4/10)'E
.	\" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.	\" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.	ds : e
.	ds 8 ss
.	ds v \h'-1'\o'\(aa\(ga'
.	ds _ \h'-1'^
.	ds . \h'-1'.
.	ds 3 3
.	ds o a
.	ds d- d\h'-1'\(ga
.	ds D- D\h'-1'\(hy
.	ds th \o'bp'
.	ds Th \o'LP'
.	ds ae ae
.	ds Ae AE
.	ds oe oe
.	ds Oe OE
.\}
.rm #[ #] #H #V #F C
.SH "NAME"
kpasswd \- Changes the issuer's password in the Authentication Database
.SH "SYNOPSIS"
\fBkpasswd\fR [\fB\-x\fR] <<\ [\fB\-principal\fR\ <\fIuser\ name\fR] >>>
    <<\ [\fB\-password\fR\ <\fIuser's\ password\fR] >>>
    <<\ [\fB\-newpassword\fR\ <\fIuser's\ new\ password\fR] >>> <<\ [\fB\-cell\fR\ <\fIcell\ name\fR] >>>
    <<\ [\fB\-servers\fR\ <\fIexplicit\ list\ of\ servers\fR+] >>> [\fB\-pipe\fR] [\fB\-help\fR]
.PP
\fBkpasswd\fR [\fB\-x\fR] <<\ [\fB\-pr\fR\ <\fIuser\ name\fR] >>> <<\ [\fB\-pa\fR\ <\fIuser's\ password\fR] >>>
    <<\ [\fB\-n\fR\ <\fIuser's\ new\ password\fR] >>> <<\ [\fB\-c\fR\ <\fIcell\ name\fR] >>>
    <<\ [\fB\-s\fR\ <\fIexplicit\ list\ of\ servers\fR+] >>> [\fB\-pi\fR] [\fB\-h\fR]
.SH "DESCRIPTION"
The \fBkpasswd\fR command changes the password recorded in an Authentication
Database entry. By default, the command interpreter changes the password
for the AFS user name that matches the issuer's local identity (UNIX
UID). To specify an alternate user, include the \fB\-principal\fR
argument. The user named by the \fB\-principal\fR argument does not have to
appear in the local password file (the \fI/etc/passwd\fR file or equivalent).
.PP
By default, the command interpreter sends the password change request to
the Authentication Server running on one of the database server machines
listed for the local cell in the \fI/usr/afs/etc/CellServDB\fR file on the
local disk; it chooses the machine at random. It consults the
\fI/usr/vice/etc/ThisCell\fR file on the local disk to learn the local cell
name. To specify an alternate cell, include the \fB\-cell\fR argument.
.PP
Unlike the UNIX \fBpasswd\fR command, the \fBkpasswd\fR command does not
restrict passwords to eight characters or less; it accepts passwords of
virtually any length. All AFS commands that require passwords (including
the \fBklog\fR, \fBkpasswd\fR, and AFS\-modified login utilities, and the
commands in the \fBkas\fR suite) accept passwords longer than eight
characters, but some other applications and operating system utilities do
not. Selecting an AFS password of eight characters or less enables the
user to maintain matching AFS and UNIX passwords.
.PP
The command interpreter makes the following checks:
.Ip "\(bu" 4
If the program \fBkpwvalid\fR exists in the same directory as the \fBkpasswd\fR
command, the command interpreter pass the new password to it for
verification. For details, see the \fIkpwvalid(8)\fR manpage.
.Ip "\(bu" 4
If the \fB\-reuse\fR argument to the kas setfields command has been used to
prohibit reuse of previous passwords, the command interpreter verifies
that the password is not too similar too any of the user's previous 20
passwords. It generates the following error message at the shell:
.Sp
.Vb 1
\&   Password was not changed because it seems like a reused password
.Ve
To prevent a user from subverting this restriction by changing the
password twenty times in quick succession (manually or by running a
script), use the \fB\-minhours\fR argument on the \fBkaserver\fR initialization
command. The following error message appears if a user attempts to change
a password before the minimum time has passed:
.Sp
.Vb 2
\&   Password was not changed because you changed it too
\&   recently; see your systems administrator
.Ve
.SH "OPTIONS"
.Ip "\fB\-x\fR" 4
Appears only for backwards compatibility.
.Ip "\fB\-principal\fR <\fIuser name\fR>" 4
Names the Authentication Database entry for which to change the
password. If this argument is omitted, the database entry with the same
name as the issuer's local identity (\s-1UNIX\s0 \s-1UID\s0) is changed.
.Ip "\fB\-password\fR <\fIuser's password\fR>" 4
Specifies the current password. Omit this argument to have the command
interpreter prompt for the password, which does not echo visibly:
.Sp
.Vb 1
\&   Old password: current_password
.Ve
.Ip "\fB\-newpassword\fR <\fIuser's new password\fR>" 4
Specifies the new password, which the \fBkpasswd\fR command interpreter
converts into an encryption key (string of octal numbers) before sending
it to the Authentication Server for storage in the user's Authentication
Database entry.
.Sp
Omit this argument to have the command interpreter prompt for the
password, which does not echo visibly:
.Sp
.Vb 2
\&   New password (RETURN to abort): <new_password>
\&   Retype new password: <new_password>
.Ve
.Ip "\fB\-cell\fR <\fIcell name\fR>" 4
Specifies the cell in which to change the password, by directing the
command to that cell's Authentication Servers. The issuer can abbreviate
the cell name to the shortest form that distinguishes it from the other
cells listed in the local \fI/usr/vice/etc/CellServDB\fR file.
.Sp
By default, the command is executed in the local cell, as defined
.Ip "\(bu" 8
First, by the value of the environment variable \s-1AFSCELL\s0.
.Ip "\(bu" 8
Second, in the \fI/usr/vice/etc/ThisCell\fR file on the client machine on
which the command is issued.
.Ip "\fB\-servers\fR <\fIexplicit list of servers\fR>" 4
Establishes a connection with the Authentication Server running on each
specified machine, rather than with all of the database server machines
listed for the relevant cell in the local copy of the
\fI/usr/vice/etc/CellServDB\fR file. The \fBkpasswd\fR command interpreter then
sends the password-changing request to one machine chosen at random from
the set.
.Ip "\fB\-pipe\fR" 4
Suppresses all output to the standard output stream or standard error
stream. The \fBkpasswd\fR command interpreter expects to receive all
necessary arguments, each on a separate line, from the standard input
stream. Do not use this argument, which is provided for use by application
programs rather than human users.
.Ip "\fB\-help\fR" 4
Prints the online help for this command. All other valid options are
ignored.
.SH "EXAMPLES"
The following example shows user pat changing her password in the ABC
Corporation cell.
.PP
.Vb 5
\&   % kpasswd
\&   Changing password for 'pat' in cell 'abc.com'.
\&   Old password:
\&   New password (RETURN to abort):
\&   Verifying, please re-enter new_password:
.Ve
.SH "PRIVILEGE REQUIRED"
None
.SH "SEE ALSO"
the \fIkas_setfields(8)\fR manpage,
the \fIkas_setpassword(8)\fR manpage,
the \fIklog(1)\fR manpage,
the \fIkpwvalid(8)\fR manpage
.SH "COPYRIGHT"
IBM Corporation 2000. <http://www.ibm.com/> All Rights Reserved.
.PP
This documentation is covered by the IBM Public License Version 1.0.  It was
converted from HTML to POD by software written by Chas Williams and Russ
Allbery, based on work by Alf Wachsmann and Elizabeth Cassell.

.rn }` ''
.IX Title "KPASSWD 1"
.IX Name "kpasswd - Changes the issuer's password in the Authentication Database"

.IX Header "NAME"

.IX Header "SYNOPSIS"

.IX Header "DESCRIPTION"

.IX Item "\(bu"

.IX Item "\(bu"

.IX Header "OPTIONS"

.IX Item "\fB\-x\fR"

.IX Item "\fB\-principal\fR <\fIuser name\fR>"

.IX Item "\fB\-password\fR <\fIuser's password\fR>"

.IX Item "\fB\-newpassword\fR <\fIuser's new password\fR>"

.IX Item "\fB\-cell\fR <\fIcell name\fR>"

.IX Item "\(bu"

.IX Item "\(bu"

.IX Item "\fB\-servers\fR <\fIexplicit list of servers\fR>"

.IX Item "\fB\-pipe\fR"

.IX Item "\fB\-help\fR"

.IX Header "EXAMPLES"

.IX Header "PRIVILEGE REQUIRED"

.IX Header "SEE ALSO"

.IX Header "COPYRIGHT"

