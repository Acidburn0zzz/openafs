.rn '' }`
''' $RCSfile$$Revision$$Date$
'''
''' $Log$
'''
.de Sh
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp
.if t .sp .5v
.if n .sp
..
.de Ip
.br
.ie \\n(.$>=3 .ne \\$3
.el .ne 3
.IP "\\$1" \\$2
..
.de Vb
.ft CW
.nf
.ne \\$1
..
.de Ve
.ft R

.fi
..
'''
'''
'''     Set up \*(-- to give an unbreakable dash;
'''     string Tr holds user defined translation string.
'''     Bell System Logo is used as a dummy character.
'''
.tr \(*W-|\(bv\*(Tr
.ie n \{\
.ds -- \(*W-
.ds PI pi
.if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\" diablo 12 pitch
.ds L" ""
.ds R" ""
'''   \*(M", \*(S", \*(N" and \*(T" are the equivalent of
'''   \*(L" and \*(R", except that they are used on ".xx" lines,
'''   such as .IP and .SH, which do another additional levels of
'''   double-quote interpretation
.ds M" """
.ds S" """
.ds N" """""
.ds T" """""
.ds L' '
.ds R' '
.ds M' '
.ds S' '
.ds N' '
.ds T' '
'br\}
.el\{\
.ds -- \(em\|
.tr \*(Tr
.ds L" ``
.ds R" ''
.ds M" ``
.ds S" ''
.ds N" ``
.ds T" ''
.ds L' `
.ds R' '
.ds M' `
.ds S' '
.ds N' `
.ds T' '
.ds PI \(*p
'br\}
.\"	If the F register is turned on, we'll generate
.\"	index entries out stderr for the following things:
.\"		TH	Title 
.\"		SH	Header
.\"		Sh	Subsection 
.\"		Ip	Item
.\"		X<>	Xref  (embedded
.\"	Of course, you have to process the output yourself
.\"	in some meaninful fashion.
.if \nF \{
.de IX
.tm Index:\\$1\t\\n%\t"\\$2"
..
.nr % 0
.rr F
.\}
.TH VOS_CHANGELOC 1 "OpenAFS" "25/Dec/2007" "AFS Command Reference"
.UC
.if n .hy 0
.if n .na
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.de CQ          \" put $1 in typewriter font
.ft CW
'if n "\c
'if t \\&\\$1\c
'if n \\&\\$1\c
'if n \&"
\\&\\$2 \\$3 \\$4 \\$5 \\$6 \\$7
'.ft R
..
.\" @(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2
.	\" AM - accent mark definitions
.bd B 3
.	\" fudge factors for nroff and troff
.if n \{\
.	ds #H 0
.	ds #V .8m
.	ds #F .3m
.	ds #[ \f1
.	ds #] \fP
.\}
.if t \{\
.	ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.	ds #V .6m
.	ds #F 0
.	ds #[ \&
.	ds #] \&
.\}
.	\" simple accents for nroff and troff
.if n \{\
.	ds ' \&
.	ds ` \&
.	ds ^ \&
.	ds , \&
.	ds ~ ~
.	ds ? ?
.	ds ! !
.	ds /
.	ds q
.\}
.if t \{\
.	ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.	ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.	ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.	ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.	ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.	ds ? \s-2c\h'-\w'c'u*7/10'\u\h'\*(#H'\zi\d\s+2\h'\w'c'u*8/10'
.	ds ! \s-2\(or\s+2\h'-\w'\(or'u'\v'-.8m'.\v'.8m'
.	ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.	ds q o\h'-\w'o'u*8/10'\s-4\v'.4m'\z\(*i\v'-.4m'\s+4\h'\w'o'u*8/10'
.\}
.	\" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds v \\k:\h'-(\\n(.wu*9/10-\*(#H)'\v'-\*(#V'\*(#[\s-4v\s0\v'\*(#V'\h'|\\n:u'\*(#]
.ds _ \\k:\h'-(\\n(.wu*9/10-\*(#H+(\*(#F*2/3))'\v'-.4m'\z\(hy\v'.4m'\h'|\\n:u'
.ds . \\k:\h'-(\\n(.wu*8/10)'\v'\*(#V*4/10'\z.\v'-\*(#V*4/10'\h'|\\n:u'
.ds 3 \*(#[\v'.2m'\s-2\&3\s0\v'-.2m'\*(#]
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.ds oe o\h'-(\w'o'u*4/10)'e
.ds Oe O\h'-(\w'O'u*4/10)'E
.	\" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.	\" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.	ds : e
.	ds 8 ss
.	ds v \h'-1'\o'\(aa\(ga'
.	ds _ \h'-1'^
.	ds . \h'-1'.
.	ds 3 3
.	ds o a
.	ds d- d\h'-1'\(ga
.	ds D- D\h'-1'\(hy
.	ds th \o'bp'
.	ds Th \o'LP'
.	ds ae ae
.	ds Ae AE
.	ds oe oe
.	ds Oe OE
.\}
.rm #[ #] #H #V #F C
.SH "NAME"
vos_changeloc \- Change a volume's entry in the VLDB
.SH "SYNOPSIS"
\fBvos changeloc\fR <<\ [\fB\-server\fR]\ <\fInew\ server\ name\fR >>>
   <<\ [\fB\-partition\fR]\ <\fInew\ partition\ location\fR >>>
   <<\ [\fB\-id\fR]\ <\fIvolume\ name\ or\ ID\fR >>>
   <<\ [\fB\-cell\fR\ <\fIcell\ name\fR] >>> [\fB\-noauth\fR] [\fB\-localauth\fR]
   [\fB\-verbose\fR] [\fB\-encrypt\fR] [\fB\-help\fR]
.PP
\fBvos changel\fR <<\ [\fB\-s\fR]\ <\fInew\ server\ name\fR >>>
   <<\ [\fB\-p\fR]\ <\fInew\ partition\ location\fR >>>
   <<\ [\fB\-i\fR]\ <\fIvolume\ name\ or\ ID\fR >>>
   <<\ [\fB\-c\fR\ <\fIcell\ name\fR] >>> [\fB\-n\fR] [\fB\-l\fR] [\fB\-v\fR] [\fB\-e\fR] [\fB\-h\fR]
.SH "DESCRIPTION"
The \fBvos changeloc\fR command changes the location of a volume in the
Volume Location Database (VLDB) without needing to contact the original
file server on which the volume was hosted. This is useful when a file
server has gone down permanently and the data that was stored on that
server has been moved to a new file server with a different name and IP
address (perhaps by mounting the same /vicepX partitions on a different
host). After moving the data and running \fBvos changeloc\fR, run \fBvos
syncvldb\fR and then \fBvos syncserv\fR against the new server to ensure full
synchronization of the VLDB with the file server.
.PP
In essence, \fBvos changeloc\fR performs the same operations on the VLDB as
\fBvos move\fR, but it does NOT move the data from one server's file system
to another.
.SH "CAUTIONS"
Using \fBvos changeloc\fR changes the VLDB without modifying the file server
data, so it inherently causes the VLDB to be out of sync with the data on
the servers. It should only be used when recovering from server failure.
If the servers are on-line, \fBvos move\fR should be used instead. It is
highly recommended that \fBvos syncvldb\fR and \fBvos syncserv\fR be run after
using the \fBvos changeloc\fR command to ensure properly synchronization of
the VLDB with the file servers.
.SH "OPTIONS"
\fBvos changeloc\fR takes the following options:
.Ip "\fB\-server\fR <\fInew server name\fR>" 4
Specifies the new server where the \s-1VLDB\s0 should believe the volume resides.
Provide the machine's \s-1IP\s0 address or its host name (either fully qualified
or using an unambiguous abbreviation). For details, see the \fIvos(1)\fR manpage.
.Ip "\fB\-partition\fR <\fIpartition name\fR>" 4
Specifies the partition where the \s-1VLDB\s0 should believe the volume resides.
entries. Provide the \fB\-server\fR argument along with this one. Provide the
partition's complete name with preceding slash (for example, \f(CW/vicepa\fR)
or use one of the three acceptable abbreviated forms. For details, see
the \fIvos(1)\fR manpage.
.Ip "\fB\-id\fR <\fIvolume name or \s-1ID\s0\fR>" 4
Specifies the name or volume \s-1ID\s0 number on which to operate.
.Ip "\fB\-cell\fR <\fIcell name\fR>" 4
Names the cell in which to run the command. Do not combine this argument
with the \fB\-localauth\fR flag. For more details, see the \fIvos(1)\fR manpage.
.Ip "\fB\-noauth\fR" 4
Assigns the unprivileged identity \f(CWanonymous\fR to the issuer. Do not
combine this flag with the \fB\-localauth\fR flag. For more details, see
the \fIvos(1)\fR manpage.
.Ip "\fB\-localauth\fR" 4
Constructs a server ticket using a key from the local
\fI/usr/afs/etc/KeyFile\fR file. The \fBvos\fR command interpreter presents it
to the Volume Server and Volume Location Server during mutual
authentication. Do not combine this flag with the \fB\-cell\fR argument or
\fB\-noauth\fR flag. For more details, see the \fIvos(1)\fR manpage.
.Ip "\fB\-verbose\fR" 4
Produces on the standard output stream a detailed trace of the command's
execution. If this argument is omitted, only warnings and error messages
appear.
.Ip "\fB\-encrypt\fR" 4
Encrypts the commands that are sent to the server.
.Ip "\fB\-help\fR" 4
Prints the online help for this command. All other valid options are
ignored.
.SH "OUTPUT"
\fBvos changeloc\fR shows a brief message upon completion:
.PP
.Vb 1
\&   Changed location to server2 /vicepa for volume user.jdoe
.Ve
.SH "EXAMPLES"
The following command changes the location of the \f(CWuser.jdoe\fR volume to
be \fI/vicepa\fR on the file server machine \f(CWserver2\fR while being verbose:
.PP
.Vb 3
\&   % vos changeloc server2 a user.jdoe -verbose
\&    done
\&   Changed location to server2 /vicepa for volume user.jdoe
.Ve
The following command changes the location of the \f(CWuser.jdoe\fR volume to
be \fI/vicepa\fR on \f(CWserver1\fR without being verbose:
.PP
.Vb 2
\&   % vos changeloc server1 a user.jdoe
\&   Changed location to server1 /vicepa for volume user.jdoe
.Ve
.SH "PRIVILEGE REQUIRED"
The issuer must be listed in the \fI/usr/afs/etc/UserList\fR file on each
database server machine. If the \fB\-localauth\fR flag is included, the issuer
must instead be logged on to a server machine as the local superuser
\f(CWroot\fR.
.SH "SEE ALSO"
the \fIvos(1)\fR manpage,
the \fIvos_move(1)\fR manpage,
the \fIvos_syncserv(1)\fR manpage,
the \fIvos_syncvldb(1)\fR manpage
.SH "COPYRIGHT"
Copyright 2007 Jason Edgecombe <jason@rampaginggeek.com>
.PP
This documentation is covered by the BSD License as written in the
doc/LICENSE file. This man page was written by Jason Edgecombe for
OpenAFS.

.rn }` ''
.IX Title "VOS_CHANGELOC 1"
.IX Name "vos_changeloc - Change a volume's entry in the VLDB"

.IX Header "NAME"

.IX Header "SYNOPSIS"

.IX Header "DESCRIPTION"

.IX Header "CAUTIONS"

.IX Header "OPTIONS"

.IX Item "\fB\-server\fR <\fInew server name\fR>"

.IX Item "\fB\-partition\fR <\fIpartition name\fR>"

.IX Item "\fB\-id\fR <\fIvolume name or \s-1ID\s0\fR>"

.IX Item "\fB\-cell\fR <\fIcell name\fR>"

.IX Item "\fB\-noauth\fR"

.IX Item "\fB\-localauth\fR"

.IX Item "\fB\-verbose\fR"

.IX Item "\fB\-encrypt\fR"

.IX Item "\fB\-help\fR"

.IX Header "OUTPUT"

.IX Header "EXAMPLES"

.IX Header "PRIVILEGE REQUIRED"

.IX Header "SEE ALSO"

.IX Header "COPYRIGHT"

